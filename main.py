import streamlit as st

def main():
    # ğŸ¦ í˜ì´ì§€ ì„¤ì •: ê¸°ë³¸ íƒ€ì´í‹€ë§Œ ë‚¨ê²¨ë´…ë‹ˆë‹¤!
    st.set_page_config(
        page_title="ğŸ’– íŒ…ì»¤ë²¨ì˜ ë‹¬ì½¤í•œ ë² ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ í‚¤ì˜¤ìŠ¤í¬ ğŸ’–",
        # layout="centered", # ì´ ì¤„ì€ ì ì‹œ ì£¼ì„ ì²˜ë¦¬ (ì œê±°)
        # initial_sidebar_state="collapsed", # ì´ ì¤„ë„ ì ì‹œ ì£¼ì„ ì²˜ë¦¬ (ì œê±°)
        # icon="ğŸ¦" # ì´ ì¤„ë„ ì ì‹œ ì£¼ì„ ì²˜ë¦¬ (ì œê±°)
    )

    st.title("ğŸ¦ ë² ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ í‚¤ì˜¤ìŠ¤í¬ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•´ìš”! âœ¨", anchor=False)
    st.subheader("ë‹¬ì½¤í•œ ì•„ì´ìŠ¤í¬ë¦¼ê³¼ í•¨ê»˜ í–‰ë³µì„ ì±„ì›Œë³´ì„¸ìš”! ğŸ˜Š", anchor=False)
    # ... (ì´í•˜ ì½”ë“œëŠ” ë™ì¼)
    st.title("ğŸ¦ ë² ìŠ¤í‚¨ë¼ë¹ˆìŠ¤ í‚¤ì˜¤ìŠ¤í¬ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•´ìš”! âœ¨", anchor=False)
    st.subheader("ë‹¬ì½¤í•œ ì•„ì´ìŠ¤í¬ë¦¼ê³¼ í•¨ê»˜ í–‰ë³µì„ ì±„ì›Œë³´ì„¸ìš”! ğŸ˜Š", anchor=False)

    st.markdown("---") # ê¹”ë”í•œ êµ¬ë¶„ì„ 

    # 1ï¸âƒ£ ë§¤ì¥/í¬ì¥ ì„ íƒ: ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ ì¦ê¸¸ê¹Œìš”?
    st.header("1. ë§¤ì¥ì—ì„œ ë“œì‹¤ë˜ìš”, ê°€ì ¸ê°€ì‹¤ë˜ìš”? ğŸ¡ğŸ“¦", anchor=False)
    order_type = st.radio(
        "ì–´ë–»ê²Œ ì´ìš©í•˜ì‹œê² ì–´ìš”?",
        ("ë§¤ì¥", "í¬ì¥"),
        index=0, # ê¸°ë³¸ê°’ì€ 'ë§¤ì¥'ìœ¼ë¡œ!
        horizontal=True, # ë‚˜ë€íˆ ì •ë ¬!
        help="ì•„ì´ìŠ¤í¬ë¦¼ì„ ë“œì‹¤ ì¥ì†Œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."
    )
    st.info(f"ì„ íƒ: **{order_type}** ë‹˜ì˜ ì£¼ë¬¸ì„ ì¤€ë¹„í• ê²Œìš”! ğŸ¥³")

    st.markdown("---")

    # 2ï¸âƒ£ ìš©ê¸° ì„ íƒ: ì–´ë–¤ ì‚¬ì´ì¦ˆë¡œ ê°€ë“ ì±„ìš¸ê¹Œìš”?
    st.header("2. ì–´ë–¤ ìš©ê¸°ì— ë‹´ì•„ë“œë¦´ê¹Œìš”? ğŸ", anchor=False)
    # ìš©ê¸° ì •ë³´ ë”•ì…”ë„ˆë¦¬: ì´ë¦„, ìµœëŒ€ ë§› ê°œìˆ˜, ê°€ê²©
    containers_info = {
        "íŒŒì¸íŠ¸ ğŸ¨ (ìµœëŒ€ 3ê°€ì§€ ë§›)": {"max_flavors": 3, "price": 8900},
        "ì¿¼í„° ğŸ¦ğŸ¦ (ìµœëŒ€ 4ê°€ì§€ ë§›)": {"max_flavors": 4, "price": 17000},
        "íŒ¨ë°€ë¦¬ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ (ìµœëŒ€ 5ê°€ì§€ ë§›)": {"max_flavors": 5, "price": 24000},
        "í•˜í”„ê°¤ëŸ° ğŸ¥³ (ìµœëŒ€ 6ê°€ì§€ ë§›)": {"max_flavors": 6, "price": 29000},
    }

    container_options = list(containers_info.keys())
    selected_container_name = st.selectbox(
        "ê°€ì¥ ëŒë¦¬ëŠ” ìš©ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”! ğŸ¤©",
        container_options,
        index=0, # ê¸°ë³¸ê°’ì€ 'íŒŒì¸íŠ¸'
        help="ì‚¬ì´ì¦ˆì— ë”°ë¼ ë‹´ì„ ìˆ˜ ìˆëŠ” ë§›ì˜ ê°œìˆ˜ê°€ ë‹¬ë¼ì ¸ìš”!"
    )

    selected_container_data = containers_info[selected_container_name]
    max_flavors_allowed = selected_container_data["max_flavors"]
    container_price = selected_container_data["price"]

    st.success(f"âœ¨ **{selected_container_name}**ì„(ë¥¼) ì„ íƒí•˜ì…¨ì–´ìš”! ìµœëŒ€ **{max_flavors_allowed}ê°€ì§€** ë§›ì„ ê³ ë¥¼ ìˆ˜ ìˆê³ , ê°€ê²©ì€ **{container_price:,.0f}ì›**ì…ë‹ˆë‹¤. ğŸ˜‹")

    st.markdown("---")

    # 3ï¸âƒ£ ì•„ì´ìŠ¤í¬ë¦¼ ë§› ì„ íƒ: ìƒìƒë§Œ í•´ë„ ë‹¬ì½¤! ğŸ­
    st.header(f"3. ì•„ì´ìŠ¤í¬ë¦¼ ë§›ì„ ê³¨ë¼ì£¼ì„¸ìš”! ğŸŒˆ (ìµœëŒ€ {max_flavors_allowed}ê°€ì§€)", anchor=False)

    available_flavors = [
        "ì—„ë§ˆëŠ” ì™¸ê³„ì¸ ğŸ‘½", "ì•„ëª¬ë“œ ë´‰ë´‰ ğŸ«", "ë² ë¦¬ë² ë¦¬ ìŠ¤íŠ¸ë¡œë² ë¦¬ ğŸ“", "ë¯¼íŠ¸ ì´ˆì½œë¦¿ ì¹© ğŸŒ¿ğŸ«",
        "ìŠˆíŒ…ìŠ¤íƒ€ âœ¨", "ë°”ëŒê³¼ í•¨ê»˜ ì‚¬ë¼ì§€ë‹¤ ğŸŒ¬ï¸", "ì‚¬ë‘ì— ë¹ ì§„ ë”¸ê¸° ğŸ’–ğŸ“", "ì´ìƒí•œ ë‚˜ë¼ì˜ ì†œì‚¬íƒ• â˜ï¸",
        "ë ˆì¸ë³´ìš° ìƒ¤ë² íŠ¸ ğŸŒˆ", "ì²´ë¦¬ì¥¬ë¹Œë ˆ ğŸ’", "í”¼ìŠ¤íƒ€ì¹˜ì˜¤ ì•„ëª¬ë“œ ğŸ’š", "ë‰´ìš• ì¹˜ì¦ˆì¼€ì´í¬ ğŸ°",
        "ì´ˆì½œë¦¿ ë¬´ìŠ¤ ğŸ«", "ì›”ë„› ğŸŒ°", "ë°”ë‹ë¼ ğŸŒ¼", "ì´ˆì½œë¦¿ ğŸ«"
    ]

    selected_flavors = st.multiselect(
        f"ë§ˆìŒê» ê³¨ë¼ë´ìš”! ìµœëŒ€ {max_flavors_allowed}ê°€ì§€! ğŸ¥³",
        available_flavors,
        default=[],
        max_selections=max_flavors_allowed, # ì—¬ê¸°ì— 'ì´í•˜ê°’ìœ¼ë¡œ'ë¥¼ ì ìš©!
        placeholder=f"ìµœëŒ€ {max_flavors_allowed}ê°€ì§€ ë§›ì„ ì„ íƒí•´ì£¼ì„¸ìš”! ğŸ¥³",
        help="ì„ íƒí•œ ìš©ê¸°ì— ë§ëŠ” ìµœëŒ€ ê°œìˆ˜ë§Œí¼ ë§›ì„ ê³ ë¥¼ ìˆ˜ ìˆì–´ìš”. ê·¸ë³´ë‹¤ ì ê²Œ ê³¨ë¼ë„ ê´œì°®ì•„ìš”!"
    )

    # ë§› ê°œìˆ˜ ìœ íš¨ì„± ê²€ì‚¬ (ìµœì†Œ 1ê°œëŠ” ê³¨ë¼ì•¼ê² ì£ ? ğŸ˜Š)
    can_proceed = False
    if not selected_flavors:
        st.warning("âš ï¸ ì–´ì„œ ë¹¨ë¦¬ ì²« ë²ˆì§¸ ë§›ì„ ê³¨ë¼ë³´ì„¸ìš”! ğŸ¤¤ (ìµœì†Œ 1ê°€ì§€ ë§›ì€ ì„ íƒí•´ì£¼ì„¸ìš”.)")
    elif len(selected_flavors) > max_flavors_allowed:
        st.error(f"âŒ ì•„ì•—! ë„ˆë¬´ ë§ì´ ê³ ë¥´ì…¨ì–´ìš”! ìµœëŒ€ **{max_flavors_allowed}ê°€ì§€** ë§›ë§Œ ì„ íƒí•´ì£¼ì„¸ìš”! ğŸ˜¥")
    else:
        st.info(f"ğŸ‘ ì„ íƒí•˜ì‹  ë§›ì€ ì´ **{len(selected_flavors)}ê°€ì§€** ì…ë‹ˆë‹¤: **{', '.join(selected_flavors)}**")
        can_proceed = True # ê²°ì œë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆê²Œ!

    st.markdown("---")

    # 4ï¸âƒ£ ìµœì¢… ê°€ê²© í™•ì¸ ë° ê²°ì œ ë°©ë²• ì„ íƒ: ì´ì œ ê²°ì œí•  ì‹œê°„! ğŸ’³
    st.header("4. ì£¼ë¬¸ì„ í™•ì¸í•˜ê³  ê²°ì œí•´ì£¼ì„¸ìš”! ğŸ’°", anchor=False)

    # ì´ ê°€ê²©ì€ ìš©ê¸° ê°€ê²©ê³¼ ë™ì¼ (ì•„ì´ìŠ¤í¬ë¦¼ ê°œìˆ˜ë¥¼ ëœ ì„ íƒí•´ë„ ê°€ê²©ì€ ê°™ì•„ìš”!)
    total_price = container_price

    st.markdown(f"### í˜„ì¬ ì´ ê²°ì œ ê¸ˆì•¡ì€... ğŸ¤© **{total_price:,.0f}ì›** ì…ë‹ˆë‹¤! ")
    
    st.subheader("ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ ê²°ì œí•˜ì‹œê² ì–´ìš”? ğŸ’³", anchor=False)
    payment_method = st.radio(
        "ì›í•˜ì‹œëŠ” ê²°ì œ ë°©ë²•ì„ ì„ íƒí•´ì£¼ì„¸ìš”.",
        ("ì¹´ë“œê²°ì œ ğŸ’³", "í˜„ê¸ˆê²°ì œ ğŸ’°"),
        index=0, # ê¸°ë³¸ê°’ì€ 'ì¹´ë“œê²°ì œ'
        horizontal=True,
        help="í¸í•˜ì‹  ë°©ë²•ìœ¼ë¡œ ê²°ì œí•˜ì‹œë©´ ë©ë‹ˆë‹¤."
    )
    st.caption(f"ì„ íƒí•˜ì‹  ê²°ì œ ë°©ë²•: **{payment_method}**")

    st.markdown("---")

    # ğŸ‰ ìµœì¢… ì£¼ë¬¸ ë²„íŠ¼!
    if st.button("ğŸ‰ ì£¼ë¬¸ ì™„ë£Œ ë° ê²°ì œí•˜ê¸° ğŸ‰", disabled=not can_proceed):
        st.success("âœ… ì£¼ë¬¸ì´ ì„±ê³µì ìœ¼ë¡œ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤! ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”! ğŸ˜Š")
        st.balloons() # ì¶•í•˜ í’ì„ !

        st.markdown("### ğŸ“ ë‹¨ ë‹˜ì˜ ì£¼ë¬¸ ë‚´ì—­")
        st.write(f"- **ì´ìš© ë°©ë²•**: {order_type} ğŸ¥³")
        st.write(f"- **ì„ íƒ ìš©ê¸°**: {selected_container_name}")
        if selected_flavors:
            st.write(f"- **ì„ íƒ ë§› ({len(selected_flavors)}ê°€ì§€)**: {', '.join(selected_flavors)} ğŸ’–")
        else:
            st.write("- **ì„ íƒëœ ë§›ì´ ì—†ìŠµë‹ˆë‹¤. (ê·¸ë˜ë„ ìš©ê¸° ê°€ê²©ì€ ë™ì¼í•´ìš”! ğŸ˜Š)**")
        st.write(f"- **ê²°ì œ ë°©ë²•**: {payment_method}")
        st.markdown(f"## ğŸ’° ìµœì¢… ê²°ì œ ê¸ˆì•¡: <span style='color:green;'>**{total_price:,.0f}ì›**</span> ì…ë‹ˆë‹¤! ë‹¤ì‹œ í•œë²ˆ ê°ì‚¬ë“œë ¤ìš”! ğŸ’–", unsafe_allow_html=True)

        st.info("ğŸ’¡ ë§›ìˆê²Œ ë“œì‹œê³  í–‰ë³µí•œ í•˜ë£¨ ë˜ì„¸ìš”! ì´ í™”ë©´ì€ ì ì‹œ í›„ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. (ì‹¤ì œ ì•±ì—ì„œëŠ” í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ì´ë‚˜ ì„¸ì…˜ ì´ˆê¸°í™” ë¡œì§ì„ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”!)")
        # ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” st.session_stateë¥¼ ì´ˆê¸°í™”í•˜ê±°ë‚˜, streamlit.experimental_rerun() ë“±ì„ ì‚¬ìš©í•´ í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        # st.experimental_rerun() # ì—¬ê¸°ì„œëŠ” ì˜ˆì‹œë¥¼ ìœ„í•´ ì£¼ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

    else:
        if not can_proceed and st.session_state.get('last_button_click_attempted', False):
            st.error("âš ï¸ ì£¼ë¬¸ì„ ì™„ë£Œí•˜ë ¤ë©´ ì•„ì´ìŠ¤í¬ë¦¼ ë§›ì„ ìµœì†Œ 1ê°€ì§€ ì´ìƒ, ê·¸ë¦¬ê³  ìµœëŒ€ í—ˆìš© ê°œìˆ˜ ì´í•˜ë¡œ ì„ íƒí•´ì£¼ì„¸ìš”! ğŸ§")
        elif not can_proceed:
            st.warning("ìœ„ì˜ ë‹¨ê³„ë¥¼ ëª¨ë‘ ì™„ë£Œí•˜ì‹œë©´ ì£¼ë¬¸ ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤! ğŸ˜Š")

# Streamlit ì•± ì‹¤í–‰
if __name__ == "__main__":
    if 'last_button_click_attempted' not in st.session_state:
        st.session_state['last_button_click_attempted'] = False
    
    main()
